<!DOCTYPE html><html><head><meta charset="UTF-8"><meta content="minimum-scale=1.0, width=device-width" name="viewport"><meta name="description" content="Data Sharing"><title>Data Sharing - Trap.apex</title><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700|Roboto+Mono"><link rel="stylesheet" href="/trap-apex/vendor/galano/galano.css"><link rel="stylesheet" href="/trap-apex/vendor/icon-12/icon-12.css"><link rel="stylesheet" href="/trap-apex/vendor/senna/senna.css"><link rel="stylesheet" href="/trap-apex/vendor/icon-16/icon-16.css"><link rel="stylesheet" href="/trap-apex/vendor/codemirror/lib/codemirror.css"><link rel="stylesheet" href="/trap-apex/vendor/codemirror/theme/dracula.css"><script src="/trap-apex/js/bundles/shared.electric.js"></script><script src="/trap-apex/vendor/senna/senna.js"></script><script src="/trap-apex/vendor/codemirror/lib/codemirror.js"></script><script src="/trap-apex/vendor/codemirror/mode/css/css.js"></script><script src="/trap-apex/vendor/codemirror/mode/javascript/javascript.js"></script><script src="/trap-apex/vendor/codemirror/mode/xml/xml.js"></script><link rel="stylesheet" href="/trap-apex/styles/main.css"></head><body data-senna=""><div data-senna-surface="" id="wrapper"><div class="senna-loading-bar"></div><div id="pageComponent"><div class="main"><main class="guide"><div class="docs"><nav class="topbar topbar-light topbar-docs"><div class="topbar-logo"><a class="topbar-logo-link" href="/trap-apex"><span class="topbar-logo-icon icon-16-hammer"></span><h3 class="topbar-logo-text">Trap.apex</h3></a></div><nav class="topbar-menu"><button class="topbar-toggle">Menu</button><ul class="topbar-list"><li class="topbar-item"><a class="topbar-link topbar-link-selected" href="/trap-apex/docs/" target="undefined"><span>Docs</span></a></li><li class="topbar-item"><a class="topbar-link " href="/trap-apex/tutorials/getting_started/step_1.html" target="undefined"><span>Tutorials</span></a></li></ul></nav></nav><nav class="sidebar"><a class="sidebar-header toggler-header-collapsed"><span class="sidebar-icon icon-16-menu"></span><span>Docs Menu</span><span class="sidebar-icon-right"><span class="icon-12-arrow-down-short"></span><span class="icon-12-arrow-up-short"></span></span></a><div class="sidebar-toggler-content toggler-collapsed"><div class="sidebar-search"><div class="page-autocomplete"><div class="form-group"><div class="input-inner-addon input-inner-addon-right"><input autocomplete="off" class="form-control" name="q" placeholder="Search Docs" ref="input" required="" type="text"><span class="input-inner-icon-helper icon-16-magnifier"></span></div></div></div></div><nav class=""><ul class="sidebar-list sidebar-list-1"><li class="sidebar-item"><a class="sidebar-link " href="/trap-apex/docs/Trigger_Handler/"><span class="sidebar-icon icon-16-flash"></span><span>Trigger Handlers</span></a></li><li class="sidebar-item active"><a class="sidebar-link sidebar-link-selected" href="/trap-apex/docs/Trigger_Execution/"><span class="sidebar-icon icon-16-code-file"></span><span>Trigger Execution</span></a><nav class=""><ul class="sidebar-list sidebar-list-1"><li class="sidebar-item"><a class="sidebar-link " href="/trap-apex/docs/Trigger_Execution/bulk_object.html"><span class="sidebar-icon icon-16-code-file"></span><span>Bulk Objects</span></a></li><li class="sidebar-item"><a class="sidebar-link " href="/trap-apex/docs/Trigger_Execution/function.html"><span class="sidebar-icon icon-16-code-file"></span><span>Functions</span></a></li><li class="sidebar-item active"><a class="sidebar-link sidebar-link-selected" href="/trap-apex/docs/Trigger_Execution/data_sharing.html"><span class="sidebar-icon icon-16-code-file"></span><span>Data Sharing</span></a></li></ul></nav></li><li class="sidebar-item"><a class="sidebar-link " href="/trap-apex/docs/Trigger_Controller/"><span class="sidebar-icon icon-16-cloud"></span><span>Trigger Controller</span></a></li></ul></nav></div></nav><div class="sidebar-offset"><header class="guide-header"><div class="container-hybrid"><h1 class="title">Data Sharing Guide</h1></div></header><div class="container-hybrid"><div class="docs-guide row"><div class="docs-content col-xs-16 col-md-9"><div class="guide-content"><h6>Data Sharing</h6><article id="1"><h2>Data Sharing</h2><p>Bulk objects help us manage the data shared inside. The basic idea is that you run a function, get the data and store it in the bulk object. The process, for the same piece of data, will only be triggered once. And then you can load the data from the bulk object in whatever way you like.</p><p>Below are methods to access the data:</p><table><thead><tr><th>Method</th><th>Description</th></tr></thead><tbody><tr><td>Object getData(String)</td><td>Get the data</td></tr><tr><td>Trap.BulkObject setData(String, Object)</td><td>Set the data</td></tr><tr><td>Boolean containsData(String)</td><td>Check if the data is contained</td></tr></tbody></table><p>Example:</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="javascript" ref="code">// ...
List<account> accounts = [ SELECT Id FROM Account WHERE Id IN = : ids ];
bulkObj.setData('Accounts', accounts);

// ...
accounts = (List<account>)bulkObj.getData('Accounts');</account></account></code></pre></div></article><article id="2"><h2>Set Data in Trigger Streams</h2><p>Trap.apex offers extra care when setting data in trigger streams.</p><p>We can set raw data directly into the bulk object.</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="javascript" ref="code">bulkObj.newStream
    .tap(bulkObj.data('data', 'test'));</code></pre></div><p>Or set the computed data from the function.</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="javascript" ref="code">bulkObj.newStream
    .tap(bulkObj.data('accounts', new CustomGetAccountsFunc(), 'ids'));</code></pre></div><p>Here the bulk object will first load data indexed by <code>ids</code> and send it to <code>CustomGetAccountsFunc</code>. After that, it will set the computed value to <code>accounts</code>. The returned function from <code>bulkObj.data</code> is passed to <code>tap</code> and the real execution is hence deferred to when the stream actually runs.</p><p>Similar methods are:</p><table><thead><tr><th>Method</th><th>Description</th></tr></thead><tbody><tr><td>Func data(String, Object)</td><td>Set the raw data</td></tr><tr><td>Func data(String, Func, List<string>)</string></td><td>Set the data from the func and arg names</td></tr><tr><td>Func data(String, Func)</td><td>Set the data from the zero-arg func</td></tr><tr><td>Func data(String, Func, String)</td><td>Set the data from one arg func</td></tr><tr><td>Func data(String, Func, String, String)</td><td>Set the data from the two arg func</td></tr><tr><td>Func data(String, Func, String, String, String)</td><td>Set the data from the three arg func</td></tr></tbody></table></article><article id="3"><h2>Get Data in Trigger Streams</h2><p>Similarly, we have support when getting data in trigger streams.</p><p>Here is how we load the data directly.</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="javascript" ref="code">bulkObj.newStream
    .tap(bulkObj.data('accounts');</code></pre></div><p>You can use it like this, but in fact this is rarely used, as it actually turns every SObject into the data of account list.</p><p>The other way is by providing data to functions.</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="javascript" ref="code">bulkObj.newStream
    .filter(bulkObj.provide('accounts', new CustomFilterFunc()));</code></pre></div><p>Here we first load the data indexed by <code>accounts</code>, and then send that as well as the current SObject to our <code>CustomFilterFunc</code>, and wrap this logic as a returned function.</p><p>Similar methods are:</p><table><thead><tr><th>Method</th><th>Description</th></tr></thead><tbody><tr><td>Func data(String)</td><td>Get the data</td></tr><tr><td>Func provide(List<string>, Func)</string></td><td>Provide args to the func</td></tr><tr><td>Func provide(String, Func)</td><td>Provide the arg to the func</td></tr><tr><td>Func provide(String, String, Func)</td><td>Provide the args to the func</td></tr><tr><td>Func provide(String, String, String, Func)</td><td>Provide the args to the func</td></tr></tbody></table></article><input type="hidden" value="Data Sharing"><input type="hidden" value="Trap.apex"></div><div class="contribute"><div class="contribute-img"><span class="icon-16-github"></span></div><div class="contribute-text"><p>Contribute on Github! <a href="https://github.com/Click-to-Cloud/Trap.apex/tree/master/src/pages/docs/Trigger_Execution/data_sharing.md" class="contribute-link" target="_blank">Edit this section</a>.</p></div></div></div><nav class="col-xs-16 col-md-offset-2 col-md-5"><div class="docs-nav-container"><div class="affix-top docs-nav"><div ref="readingContainer"></div></div></div></nav></div></div></div></div></main></div></div><script src="/trap-apex/js/bundles/pXfNv.js"></script><script>var data = '{"pageLocation":"index.children.docs.children.Trigger_Execution.children.data_sharing","site":{"title":"Trap.apex","githubRepo":"Click-to-Cloud/Trap.apex","googleAnalytics":"","index":{"title":"Home","description":" Trap.apex is a versatile functional reactive library to handle Salesforce triggers.","srcFilePath":"src/pages/index.soy","id":"pages","location":"/./","url":"/trap-apex/./","children":{"docs":{"title":"Docs","description":"Everything you need to know to get started.","srcFilePath":"src/pages/docs/index.soy","id":"docs","location":"/docs/","url":"/trap-apex/docs/","children":{"search":{"title":"Search","description":"Find what you\'re looking for in the documentation.","hidden":true,"srcFilePath":"src/pages/docs/search.soy","id":"search","location":"/docs/search.html","url":"/trap-apex/docs/search.html"},"Trigger_Controller":{"title":"Trigger Controller","description":"Trigger Controller","layout":"guide","icon":"cloud","weight":4,"srcFilePath":"src/pages/docs/Trigger_Controller/index.md","id":"Trigger_Controller","location":"/docs/Trigger_Controller/","url":"/trap-apex/docs/Trigger_Controller/"},"Trigger_Execution":{"children":{"bulk_object":{"title":"Bulk Objects","description":"Bulk Objects","layout":"guide","icon":"code-file","weight":2,"srcFilePath":"src/pages/docs/Trigger_Execution/bulk_object.md","id":"bulk_object","location":"/docs/Trigger_Execution/bulk_object.html","url":"/trap-apex/docs/Trigger_Execution/bulk_object.html"},"data_sharing":{"title":"Data Sharing","description":"Data Sharing","layout":"guide","icon":"code-file","weight":4,"srcFilePath":"src/pages/docs/Trigger_Execution/data_sharing.md","id":"data_sharing","location":"/docs/Trigger_Execution/data_sharing.html","url":"/trap-apex/docs/Trigger_Execution/data_sharing.html","active":true},"function":{"title":"Functions","description":"Functions","layout":"guide","icon":"code-file","weight":3,"srcFilePath":"src/pages/docs/Trigger_Execution/function.md","id":"function","location":"/docs/Trigger_Execution/function.html","url":"/trap-apex/docs/Trigger_Execution/function.html"}},"title":"Trigger Execution","description":"Trigger Execution","layout":"guide","icon":"code-file","weight":2,"srcFilePath":"src/pages/docs/Trigger_Execution/index.md","id":"Trigger_Execution","location":"/docs/Trigger_Execution/","url":"/trap-apex/docs/Trigger_Execution/","childIds":["bulk_object","function","data_sharing"],"active":true},"Trigger_Handler":{"title":"Trigger Handlers","description":"Trigger Handlers","layout":"guide","icon":"flash","weight":1,"srcFilePath":"src/pages/docs/Trigger_Handler/index.md","id":"Trigger_Handler","location":"/docs/Trigger_Handler/","url":"/trap-apex/docs/Trigger_Handler/"}},"childIds":["Trigger_Handler","Trigger_Execution","Trigger_Controller","search"],"active":true},"tutorials":{"title":"Tutorials","description":"The tutorials","url":"/trap-apex/tutorials/getting_started/step_1.html","layout":false,"srcFilePath":"src/pages/tutorials/index.soy","id":"tutorials","location":"/tutorials/","customURL":true,"children":{"getting_started":{"title":"Getting Started","description":"The Getting Started Tutorial","tutorialTitle":"Getting started with Trap.apex","url":"/trap-apex/tutorials/getting_started/step_1.html","layout":false,"srcFilePath":"src/pages/tutorials/getting_started/index.soy","id":"getting_started","location":"/tutorials/getting_started/","customURL":true,"children":{"step_1":{"title":"Installation","description":"Include Apex files","buttonTitle":"Done","parentId":"getting_started","layout":"tutorial","time":90,"weight":1,"srcFilePath":"src/pages/tutorials/getting_started/step_1.md","id":"step_1","location":"/tutorials/getting_started/step_1.html","url":"/trap-apex/tutorials/getting_started/step_1.html"},"step_10":{"title":"Normal Trigger Event Handler","description":"Normal Trigger Event Handler","buttonTitle":"Done","parentId":"getting_started","layout":"tutorial","time":90,"weight":10,"srcFilePath":"src/pages/tutorials/getting_started/step_10.md","id":"step_10","location":"/tutorials/getting_started/step_10.html","url":"/trap-apex/tutorials/getting_started/step_10.html"},"step_11":{"title":"Trigger Context","description":"Trigger Context","buttonTitle":"Done","parentId":"getting_started","layout":"tutorial","time":90,"weight":11,"srcFilePath":"src/pages/tutorials/getting_started/step_11.md","id":"step_11","location":"/tutorials/getting_started/step_11.html","url":"/trap-apex/tutorials/getting_started/step_11.html"},"step_12":{"title":"Unit Test","description":"Unit Test","buttonTitle":"Done","parentId":"getting_started","layout":"tutorial","time":90,"weight":12,"srcFilePath":"src/pages/tutorials/getting_started/step_12.md","id":"step_12","location":"/tutorials/getting_started/step_12.html","url":"/trap-apex/tutorials/getting_started/step_12.html"},"step_13":{"title":"Take Only Trigger Execution","description":"Take Only Trigger Execution","buttonTitle":"Done","parentId":"getting_started","layout":"tutorial","time":90,"weight":13,"srcFilePath":"src/pages/tutorials/getting_started/step_13.md","id":"step_13","location":"/tutorials/getting_started/step_13.html","url":"/trap-apex/tutorials/getting_started/step_13.html"},"step_2":{"title":"Preliminary Knowledge","description":"Preliminary Knowledge","buttonTitle":"Done","parentId":"getting_started","layout":"tutorial","time":90,"weight":2,"srcFilePath":"src/pages/tutorials/getting_started/step_2.md","id":"step_2","location":"/tutorials/getting_started/step_2.html","url":"/trap-apex/tutorials/getting_started/step_2.html"},"step_3":{"title":"Create Triggers","description":"Create Triggers","buttonTitle":"Done","parentId":"getting_started","layout":"tutorial","time":90,"weight":3,"srcFilePath":"src/pages/tutorials/getting_started/step_3.md","id":"step_3","location":"/tutorials/getting_started/step_3.html","url":"/trap-apex/tutorials/getting_started/step_3.html"},"step_4":{"title":"Trigger Handler","description":"Trigger Handler","buttonTitle":"Done","parentId":"getting_started","layout":"tutorial","time":90,"weight":4,"srcFilePath":"src/pages/tutorials/getting_started/step_4.md","id":"step_4","location":"/tutorials/getting_started/step_4.html","url":"/trap-apex/tutorials/getting_started/step_4.html"},"step_5":{"title":"Bulk Object","description":"Bulk Object","buttonTitle":"Done","parentId":"getting_started","layout":"tutorial","time":90,"weight":5,"srcFilePath":"src/pages/tutorials/getting_started/step_5.md","id":"step_5","location":"/tutorials/getting_started/step_5.html","url":"/trap-apex/tutorials/getting_started/step_5.html"},"step_6":{"title":"Find Specific Objects","description":"Find Specific Objects","buttonTitle":"Done","parentId":"getting_started","layout":"tutorial","time":90,"weight":6,"srcFilePath":"src/pages/tutorials/getting_started/step_6.md","id":"step_6","location":"/tutorials/getting_started/step_6.html","url":"/trap-apex/tutorials/getting_started/step_6.html"},"step_7":{"title":"Data Sharing","description":"Data Sharing","buttonTitle":"Done","parentId":"getting_started","layout":"tutorial","time":90,"weight":7,"srcFilePath":"src/pages/tutorials/getting_started/step_7.md","id":"step_7","location":"/tutorials/getting_started/step_7.html","url":"/trap-apex/tutorials/getting_started/step_7.html"},"step_8":{"title":"Catch All Events","description":"Catch All Events","buttonTitle":"Done","parentId":"getting_started","layout":"tutorial","time":90,"weight":8,"srcFilePath":"src/pages/tutorials/getting_started/step_8.md","id":"step_8","location":"/tutorials/getting_started/step_8.html","url":"/trap-apex/tutorials/getting_started/step_8.html"},"step_9":{"title":"Trigger Controller","description":"Trigger Controller","buttonTitle":"Done","parentId":"getting_started","layout":"tutorial","time":90,"weight":9,"srcFilePath":"src/pages/tutorials/getting_started/step_9.md","id":"step_9","location":"/tutorials/getting_started/step_9.html","url":"/trap-apex/tutorials/getting_started/step_9.html"}},"childIds":["step_1","step_2","step_3","step_4","step_5","step_6","step_7","step_8","step_9","step_10","step_11","step_12","step_13"]}},"childIds":["getting_started"]}},"childIds":["docs","tutorials"]},"basePath":"/trap-apex","topbar":[{"href":"/trap-apex/docs/","label":"Docs","selected":true},{"href":"/trap-apex/tutorials/getting_started/step_1.html","label":"Tutorials"}]}}'; if (typeof electric !== 'undefined') {electric.init(data);}else {document.addEventListener('DOMContentLoaded', function() {electric.init(data);});}</script></div><script data-senna-track="permanent" src="/trap-apex/js/electric/electric.js"></script></body></html>